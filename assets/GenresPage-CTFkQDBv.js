import{j as e,r as t,b as C}from"./vendor-dGG96ymH.js";import{L as b,a as p}from"./index-G1tSvkQe.js";import{F as E}from"./FilmCard-BiL5mJ2n.js";import{m as F}from"./proxy-CNDFD7-x.js";import"./react-DJG_os-6.js";const D=({genre:r,movies:d,onClick:n})=>{const m=d.find(h=>h.genres.includes(r))?.posterUrl||"/images/genres/default.jpg";return e.jsxs("div",{className:"genres-card",onClick:n,children:[e.jsx("img",{src:m,alt:r,className:"genres-card__image"}),e.jsx("span",{className:"genres-card__genre",children:r})]})},P=r=>t.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},t.createElement("path",{d:"M18.047 20.0012L26.2967 28.2507L23.9397 30.6077L13.333 20.0012L23.9397 9.39453L26.2967 11.7515L18.047 20.0012Z",fill:"white"})),v=10,A=()=>{const[r,d]=t.useState([]),[n,g]=t.useState(null),[m,h]=t.useState([]),[x,c]=t.useState([]),[w,u]=t.useState(1),[y,l]=t.useState(!1),[f,j]=t.useState(!1),[M,i]=t.useState(!0),G=C();t.useEffect(()=>{(async()=>{try{l(!0);const a=await p.getGenres(),o=await p.getMovies();d(a),h(o)}catch(a){console.error("Ошибка при загрузке жанров:",a)}finally{l(!1)}})()},[]);const _=async(s,a=1)=>{try{return await p.getMoviesByGenre(s,a,v)}catch(o){return console.error("Ошибка при загрузке фильмов по жанру:",o),[]}},L=async s=>{g(s),l(!0),u(1),c([]),i(!0);try{const a=await _(s,1);c(a),a.length<v&&i(!1)}catch(a){console.error("Ошибка при загрузке фильмов:",a),c([]),i(!1)}finally{l(!1)}},N=async()=>{if(!n||f)return;j(!0);const s=w+1;try{const a=await _(n,s);a.length>0?(c(o=>[...o,...a]),u(s),a.length<v&&i(!1)):i(!1)}catch(a){console.error("Ошибка при загрузке дополнительных фильмов:",a),i(!1)}finally{j(!1)}},S=s=>{G(`/movie/${s}`)},k=()=>{g(null),c([]),u(1),i(!0)};return y?e.jsx(b,{}):e.jsx(F.div,{initial:{opacity:0,x:200},transition:{duration:.5},whileInView:{opacity:1,x:0},viewport:{once:!0},className:"genres-page",children:e.jsxs("div",{className:"container",children:[!n&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"genres-page__title",children:"Жанры фильмов"}),e.jsx("div",{className:"genres-page__grid-genres",children:r.map(s=>e.jsx(D,{genre:s,movies:m,onClick:()=>L(s)},s))})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"genres-page__back-link",onClick:k,children:[e.jsx(P,{className:"genres-page__back-icon",width:40,height:40,"aria-hidden":!0}),n]}),x.length===0?e.jsx("p",{children:"Фильмы не найдены"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"genres-page__grid",children:x.map(s=>e.jsx(E,{movie:s,showRank:!1,onClick:()=>S(s.id)},s.id))}),M&&e.jsx("div",{className:"genres-page__load-more",children:e.jsx("button",{className:"btn btn--primary genres-page__load-more-btn",onClick:N,disabled:f,children:f?"Загрузка...":"Показать ещё"})})]})]})]})})};export{A as default};
