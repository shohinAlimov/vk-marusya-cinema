import{j as e,r,b as C}from"./vendor-dGG96ymH.js";import{L as b,a as v}from"./index-DjneE7V-.js";import{F}from"./FilmCard-BOKcYCYd.js";import"./react-DJG_os-6.js";const D=({genre:i,movies:d,onClick:t})=>{const h=d.find(m=>m.genres.includes(i))?.posterUrl||"/images/genres/default.jpg";return e.jsxs("div",{className:"genres-card",onClick:t,children:[e.jsx("img",{src:h,alt:i,className:"genres-card__image"}),e.jsx("span",{className:"genres-card__genre",children:i})]})},E="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.047%2020.0012L26.2967%2028.2507L23.9397%2030.6077L13.333%2020.0012L23.9397%209.39453L26.2967%2011.7515L18.047%2020.0012Z'%20fill='white'/%3e%3c/svg%3e",p=10,U=()=>{const[i,d]=r.useState([]),[t,g]=r.useState(null),[h,m]=r.useState([]),[x,c]=r.useState([]),[M,f]=r.useState(1),[y,l]=r.useState(!1),[u,j]=r.useState(!1),[w,n]=r.useState(!0),G=C();r.useEffect(()=>{(async()=>{try{l(!0);const a=await v.getGenres(),o=await v.getMovies();d(a),m(o)}catch(a){console.error("Ошибка при загрузке жанров:",a)}finally{l(!1)}})()},[]);const _=async(s,a=1)=>{try{return await v.getMoviesByGenre(s,a,p)}catch(o){return console.error("Ошибка при загрузке фильмов по жанру:",o),[]}},L=async s=>{g(s),l(!0),f(1),c([]),n(!0);try{const a=await _(s,1);c(a),a.length<p&&n(!1)}catch(a){console.error("Ошибка при загрузке фильмов:",a),c([]),n(!1)}finally{l(!1)}},N=async()=>{if(!t||u)return;j(!0);const s=M+1;try{const a=await _(t,s);a.length>0?(c(o=>[...o,...a]),f(s),a.length<p&&n(!1)):n(!1)}catch(a){console.error("Ошибка при загрузке дополнительных фильмов:",a),n(!1)}finally{j(!1)}},k=s=>{G(`/movie/${s}`)},S=()=>{g(null),c([]),f(1),n(!0)};return y?e.jsx(b,{}):e.jsx("div",{className:"genres-page",children:e.jsxs("div",{className:"container",children:[!t&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"genres-page__title",children:"Жанры фильмов"}),e.jsx("div",{className:"genres-page__grid-genres",children:i.map(s=>e.jsx(D,{genre:s,movies:h,onClick:()=>L(s)},s))})]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"genres-page__back-link",onClick:S,children:[e.jsx(E,{className:"genres-page__back-icon",width:40,height:40,"aria-hidden":!0}),t]}),x.length===0?e.jsx("p",{children:"Фильмы не найдены"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"genres-page__grid",children:x.map(s=>e.jsx(F,{movie:s,showRank:!1,onClick:()=>k(s.id)},s.id))}),w&&e.jsx("div",{className:"genres-page__load-more",children:e.jsx("button",{className:"btn btn--primary genres-page__load-more-btn",onClick:N,disabled:u,children:u?"Загрузка...":"Показать ещё"})})]})]})]})})};export{U as default};
