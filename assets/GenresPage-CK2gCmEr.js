import{j as e,r,b as C}from"./vendor-dGG96ymH.js";import{L as b,a as v}from"./index-C9GYjjd4.js";import{F as E}from"./FilmCard-Bz46KLcF.js";import"./react-DJG_os-6.js";const F=({genre:t,movies:d,onClick:n})=>{const h=d.find(m=>m.genres.includes(t))?.posterUrl||"/images/genres/default.jpg";return e.jsxs("div",{className:"genres-card",onClick:n,children:[e.jsx("img",{src:h,alt:t,className:"genres-card__image"}),e.jsx("span",{className:"genres-card__genre",children:t})]})},D=t=>r.createElement("svg",{width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M18.047 20.0012L26.2967 28.2507L23.9397 30.6077L13.333 20.0012L23.9397 9.39453L26.2967 11.7515L18.047 20.0012Z",fill:"white"})),p=10,U=()=>{const[t,d]=r.useState([]),[n,g]=r.useState(null),[h,m]=r.useState([]),[x,c]=r.useState([]),[M,f]=r.useState(1),[y,l]=r.useState(!1),[u,j]=r.useState(!1),[w,o]=r.useState(!0),G=C();r.useEffect(()=>{(async()=>{try{l(!0);const a=await v.getGenres(),i=await v.getMovies();d(a),m(i)}catch(a){console.error("Ошибка при загрузке жанров:",a)}finally{l(!1)}})()},[]);const _=async(s,a=1)=>{try{return await v.getMoviesByGenre(s,a,p)}catch(i){return console.error("Ошибка при загрузке фильмов по жанру:",i),[]}},L=async s=>{g(s),l(!0),f(1),c([]),o(!0);try{const a=await _(s,1);c(a),a.length<p&&o(!1)}catch(a){console.error("Ошибка при загрузке фильмов:",a),c([]),o(!1)}finally{l(!1)}},N=async()=>{if(!n||u)return;j(!0);const s=M+1;try{const a=await _(n,s);a.length>0?(c(i=>[...i,...a]),f(s),a.length<p&&o(!1)):o(!1)}catch(a){console.error("Ошибка при загрузке дополнительных фильмов:",a),o(!1)}finally{j(!1)}},S=s=>{G(`/movie/${s}`)},k=()=>{g(null),c([]),f(1),o(!0)};return y?e.jsx(b,{}):e.jsx("div",{className:"genres-page",children:e.jsxs("div",{className:"container",children:[!n&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"genres-page__title",children:"Жанры фильмов"}),e.jsx("div",{className:"genres-page__grid-genres",children:t.map(s=>e.jsx(F,{genre:s,movies:h,onClick:()=>L(s)},s))})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"genres-page__back-link",onClick:k,children:[e.jsx(D,{className:"genres-page__back-icon",width:40,height:40,"aria-hidden":!0}),n]}),x.length===0?e.jsx("p",{children:"Фильмы не найдены"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"genres-page__grid",children:x.map(s=>e.jsx(E,{movie:s,showRank:!1,onClick:()=>S(s.id)},s.id))}),w&&e.jsx("div",{className:"genres-page__load-more",children:e.jsx("button",{className:"btn btn--primary genres-page__load-more-btn",onClick:N,disabled:u,children:u?"Загрузка...":"Показать ещё"})})]})]})]})})};export{U as default};
