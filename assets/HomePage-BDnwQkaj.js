import{r as t,b as f,j as e}from"./vendor-dGG96ymH.js";import{a as h,L as x,S as j,b as p}from"./index-B3PcTXOX.js";import{F as g}from"./FilmBanner-CV38CYTH.js";import{F as v}from"./FilmCard-CiQnctao.js";import"./react-DJG_os-6.js";const M=()=>{const[r,o]=t.useState(null),[i,c]=t.useState(!1),[l,n]=t.useState(null),m=t.useRef(!1),d=t.useCallback(async()=>{c(!0),n(null);try{const s=await h.getRandomMovie();o(s)}catch(s){const a=s instanceof Error?s.message:"Произошла ошибка";n(a),console.error("Ошибка при получении случайного фильма:",s)}finally{c(!1)}},[]),u=t.useCallback(()=>{d()},[d]);return t.useEffect(()=>{m.current||(d(),m.current=!0)},[d]),{movie:r,isLoading:i,error:l,refetchMovie:u}},S=()=>{const{movie:r,isLoading:o,error:i,refetchMovie:c}=M(),l=f(),n=()=>{r&&l(`/movie/${r.id}`)};return o?e.jsx(x,{}):i?e.jsxs("div",{children:["Ошибка: ",i]}):r?e.jsx(e.Fragment,{children:e.jsx(g,{movie:r,onRefreshRequest:c,showRefresh:!0,onDetailsClick:n})}):e.jsx("div",{children:"Фильм не найден"})},_=({onMovieClick:r})=>{const[o,i]=t.useState([]),[c,l]=t.useState(!0),[n,m]=t.useState(null),d=async()=>{try{l(!0),m(null);const s=await h.getTopMovies(10);i(s)}catch(s){const a=s instanceof Error?s.message:"Произошла ошибка";m(a)}finally{l(!1)}};t.useEffect(()=>{d()},[]);const u=s=>{r&&r(s)};return c?e.jsx(x,{}):n?e.jsxs("div",{children:["Ошибка: ",n]}):o?e.jsxs("div",{className:"top-movies",children:[e.jsxs("div",{className:"container",children:[e.jsx("h2",{className:"top-movies__title",children:"Топ 10 фильмов"}),e.jsx("div",{className:"top-movies__grid",children:o.map((s,a)=>e.jsx(v,{movie:s,index:a,onClick:u},s.id))})]}),e.jsx(j,{children:o.map((s,a)=>e.jsx(p,{className:"top-movies__slide",children:e.jsx(v,{movie:s,index:a,onClick:u})},s.id))})]}):e.jsx("div",{children:"Фильмы не найдены"})},F=()=>{const r=f(),o=i=>{r(`/movie/${i}`)};return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"home-page__random-section",children:e.jsx("div",{className:"container",children:e.jsx(S,{})})}),e.jsx("section",{className:"home-page__top-section",children:e.jsx(_,{onMovieClick:o})})]})};export{F as default};
